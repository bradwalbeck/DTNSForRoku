<?xml version="1.0" encoding="utf-8" ?>
<component name="ImageRotator" extends="Group">
    <interface>
        <field id="rotationInterval" type="integer" value="5000" />
    </interface>
    <script type="text/brightscript">
        <![CDATA[
        sub init()
            m.imageIndex = 0
            m.rotationTimer = createObject("roTimespan")
            m.images = loadBackgroundImages()
            startRotation()
        end sub
        
        function loadBackgroundImages() as object
            images = []
            folder = "pkg:/images/background"
            files = listDir(folder)
            for each file in files
                if right(file, 4) = ".jpg" or right(file, 4) = ".png"
                    images.push(folder + "/" + file)
                end if
            next
            return images
        end function
        
        sub startRotation()
            if m.images.count() > 0
                rotateImage()
            end if
        end sub
        
        sub rotateImage()
            m.imageIndex = (m.imageIndex + 1) mod m.images.count()
            m.top.uri = m.images[m.imageIndex]
            m.rotationTimer.mark()
        end sub
        ]]>
    </script>
</component>